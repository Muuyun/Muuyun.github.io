---

title: 正则表达式基础
tags: linux
categories: linux

---

##  grep模式匹配命令



`grep`命令用于打印输出文本中匹配的模式串，它使用正则表达式作为模式匹配的条件。`grep`支持三种正则表达式引擎，分别用三个参数指定：

| 参数 | 说明                     |
| ---- | ------------------------ |
| -E   | POSIX扩展正则表达式，ERE |
| -G   | POSIX基本正则表达式，BRE |
| -P   | Perl正则表达式，PCRE     |



`grep`命令的常用参数：

| 参数           | 说明                                                         |
| -------------- | ------------------------------------------------------------ |
| -b             | 将二进制文件作为文本来进行匹配                               |
| -c             | 统计以模式匹配的数目                                         |
| -i             | 忽略大小写                                                   |
| -n             | 显示匹配文本所在行的行号                                     |
| -v             | 反选，输出不匹配行的内容                                     |
| -r             | 递归匹配查找                                                 |
| -A n           | n为正整数，表示after的意思，除了列出匹配行之外，还列出后面的n行 |
| -B n           | n为正整数，表示before的意思，除了列出匹配行之外，还列出后面的n行 |
| --color = auto | 将输出中的匹配项设置为自动颜色显示                           |



- 数量

```
# 将匹配以'z'开头以'o'结尾的所有字符串
$ echo 'zero\nzo\nzoo' | grep 'z.*o'
# 将匹配以'z'开头以'o'结尾，中间包含一个任意字符的字符串
$ echo 'zero\nzo\nzoo' | grep 'z.o'
# 将匹配以'z'开头,以任意多个'o'结尾的字符串
$ echo 'zero\nzo\nzoo' | grep 'zo*'
```



- 选择

```
# grep默认是区分大小写的，这里将匹配所有的小写字母
$ echo '1234\nabcd' | grep '[a-z]'
# 将匹配所有的数字
$ echo '1234\nabcd' | grep '[0-9]'
# 将匹配所有的数字
$ echo '1234\nabcd' | grep '[[:digit:]]'
# 将匹配所有的小写字母
$ echo '1234\nabcd' | grep '[[:lower:]]'
# 将匹配所有的大写字母
$ echo '1234\nabcd' | grep '[[:upper:]]'
# 将匹配所有的字母和数字，包括0-9,a-z,A-Z
$ echo '1234\nabcd' | grep '[[:alnum:]]'
# 将匹配所有的字母
$ echo '1234\nabcd' | grep '[[:alpha:]]'
```



## sed流编辑器



sed : 用于过滤和转换文本的流编辑器



sed 命令基本格式：

```
sed [参数]... [执行命令] [输入文件]...
# 形如：
$ sed -i 's/sad/happy/' test # 表示将test文件中的"sad"替换为"happy"
```

| 参数         | 说明                                                         |
| ------------ | ------------------------------------------------------------ |
| -n           | 安静模式，只打印受影响的行，默认打印输入数据的全部内容       |
| -e           | 用于在脚本中添加多个执行命令一次执行，在命令行中执行多个命令通常不需要加该参数 |
| -f  filename | 指定执行filename文件中的命令                                 |
| -r           | 使用扩展正则表达式，默认为标准正则表达式                     |
| -i           | 将直接修改输入文件内容，而不是打印到标准输出设备             |



sed执行命令格式：

```
[n1][,n2]command
[n1][~step]command
# 其中一些命令可以在后面加上作用范围，形如：
$ sed -i 's/sad/happy/g' test # g表示全局范围
$ sed -i 's/sad/happy/4' test # 4表示指定行中的第四个匹配字符串
```



其中n1,n2表示输入内容的行号，它们之间为`,`逗号则表示从n1到n2行，如果为`～`波浪号则表示从n1开始以step为步进的所有行；command为执行动作，下面为一些常用动作指令：



| 命令 | 说明                               |
| ---- | ---------------------------------- |
| `s`  | 行内替换                           |
| `c`  | 整行替换                           |
| `a`  | 插入到指定行的后面                 |
| `i`  | 插入到指定行的前面                 |
| `p`  | 打印指定行，通常与`-n`参数配合使用 |
| `d`  | 删除指定行                         |



## AWK文本处理语言

awk所有的操作都是基于pattern(模式)—action(动作)对来完成的，如下面的形式：

```
$ pattern {action}
```

| 变量名   | 说明                                                         |
| -------- | ------------------------------------------------------------ |
| FILENAME | 当前输入文件名，若有多个文件，则只表示第一个。如果输入是来自标准输入，则为空字符串 |
| $0       | 当前记录的内容                                               |
| $N       | N表示字段号，最大值为`NF`变量的值                            |
| FS       | 字段分隔符，由正则表达式表示，默认为" "空格                  |
| RS       | 输入记录分隔符，默认为"\n"，即一行为一个记录                 |
| NF       | 当前记录字段数                                               |
| NR       | 已经读入的记录数                                             |
| FNR      | 当前输入文件的记录数，请注意它与NR的区别                     |
| OFS      | 输出字段分隔符，默认为" "空格                                |
| ORS      | 输出记录分隔符，默认为"\n"                                   |

